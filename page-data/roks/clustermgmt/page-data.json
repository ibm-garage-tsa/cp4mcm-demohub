{"componentChunkName":"component---src-pages-roks-clustermgmt-index-mdx","path":"/roks/clustermgmt/","result":{"pageContext":{"frontmatter":{"title":"Lab 1 - Multicluster Management - ROKS","description":null},"relativePagePath":"/roks/clustermgmt/index.mdx","titleType":"page","MdxNode":{"id":"b97f33dc-9b00-5b48-8f4d-95a96e2691f1","children":[],"parent":"8dea7b8f-adf1-595d-aae1-d4c463037419","internal":{"content":"---\ntitle: Lab 1 - Multicluster Management - ROKS\ndescription:\n---\n\n<FeatureCard\n  title=\"Multicluster Management with IBM Cloud Pak for Multicloud Management\"\n  color=\"dark\"\n  >\n\n![banner](/images/clustermgmt-banner.jpg)\n\n</FeatureCard>\n\n\n<AnchorLinks>\n  <AnchorLink>Lab Overview</AnchorLink>\n  <AnchorLink>Prerequisite</AnchorLink>\n  <AnchorLink>Business Context</AnchorLink>\n  <AnchorLink>Add Managed Clusters</AnchorLink>\n  <AnchorLink>Visualize Clusters</AnchorLink>\n  <AnchorLink>Deploy an Application</AnchorLink>\n  <AnchorLink>Manage Cluster Objects</AnchorLink>\n  <AnchorLink>Summary</AnchorLink>\n</AnchorLinks>\n\nNote: 'This lab is to be used for CP4MCM 2.1.X on ROKS.'\n\n***\n\n## Lab Overview\n\nIBM Cloud Pak for Multicloud Management provides consistent visibility, automation, and governance across a range of multicloud management capabilities such as cost and asset management, infrastructure management, application management, multi-cluster management, edge management, and integration with existing tools and processes. Customers can leverage Cloud Pak for Multicloud Management to simplify their IT and application ops management, while increasing flexibility and cost savings with intelligent data analysis driven by predictive signals.\n\nIBM Cloud Pak for Multicloud Management can manage Kubernetes clusters that are deployed on any target infrastructure - either in your own data center or in a public cloud.\n\nIn this tutorial, you will explore the following key capabilities:\n-\t`Understand Cloud Pak for Multicloud Management`\n-\t`Learn how to add a managed cluster`\n-\t`Learn how to deploy an application chart from catalog`\n-\t`Learn how to manage cluster objects spanning multiple clusters`\n\n***\n\n## Prerequisite\n\n- You need to have your personal CP4MCM on ROKS environment (check [here](../../environment/overview/) how to request it).\n- You need to pre-install all necessaries CLI tools (check [here](../installcli/) how to install them).\n\n***\n\n## Business Context\n\nAs a member of the Cloud Operation team, you are having problems to manage your multicloud hybrid world. Operate your cloud-based services and data across multiple providers is overwhelming your team.\nYour company is deploying multiple Kubernetes clusters to address their specific needs. Some Dev teams are deploying clusters across public and private clouds, and some are deploying clusters across regions, and some are deploying clusters to support the development and test needs.\n\nAs different teams deploy more clusters, new challenges are introduced:\n-\tWhere are my services running?\n-\tHow can I monitor applications across clusters and clouds?\n-\tHow can I manage clusters as if they were one environment?\n-\tHow do I monitor usage across clouds?\n-\tWhere are the failed components?\n-\tHow do I deploy applications across these environments?\n-\tHow do I move workloads across environments?\n-\tHow do I set consistent security policies across environments?\n-\tWhich clusters are compliant?\n-\tHow can I place workloads based on capacity, policy?\n\nBecause of that, you want to explore how IBM Cloud Pak for Multicloud Management, provides consistent visibility, governance and automation of your complex environment.\n\nIn this tutorial, you use two Red Hat OpenShift cluster (ROKS) clusters.\n-\tHub cluster includes management console, federated monitoring, and all the controllers. In this tutorial, you identify Hub cluster as hub-cluster. Here is the OpenShift cluster.\n-\tManaged cluster includes klusterlet components that communicate status back to the Hub cluster. In this tutorial, you identify managed cluster as managed-roks.\n\nThe relationship between hub and managed clusters is shown in the diagram below:\n\n![](images/1-cluster-mgmt-img.png)\n\nIn this tutorial, you will log in to the Hub cluster to do cluster management.\n\nYou will complete the following tasks:\n-\tAdd a managed cluster\n-\tVisualize cluster topology\n-\tVisualize clusters and launch to each cluster\n-\tDeploy an application chart to remote cluster\n-\tManage cluster objects\n\n***\n\n## Add Managed Clusters\n\nIn this section, you will add two new managed clusters in your Control Panel. As explained before, you will add your OpenShift ROKS Hub cluster and your OpenShift ROKS Managed cluster.\n\n1.To start the lab, you should be in your Cloud Pak for Multicloud Management Web Console. If you are not, check [here](../beforestart/) how to open your console page.\n\n  ![](images/2-cluster-mgmt-img.png)\n\n2.Now, let's explore the Cluster view. Click the hamburger **Menu** (1) and select **Automated Infrastructure -> Clusters** (2).\n\n  ![](images/3-cluster-mgmt-img.png)\n\n3.Initially, you shouldn't have any cluster registered here. Let's add our first cluster. Click **Add cluster**.\n\n  ![](images/4-cluster-mgmt-img.png)\n\n4.You can add a cluster by Importing an existing cluster or provisioning a new cluster that uses IBM Cloud Automation Manager. We use the first option. Select **Import an Existing cluster** (1) and click **Import** (2).\n\n  ![](images/5-cluster-mgmt-img.png)\n\n5.Enter **hub-cluster** for cluster name (1) and **hub-cluster** for namespace (2). You can view the yaml file and change the settings as needed (3). To import an OpenShift cluster no further changes are needed. Click **Generate command** to continue (4).\n\n  ![](images/6-cluster-mgmt-img.png)\n\n6.A curl command is generated that you will use to add the new cluster. Click **Copy command** button (1) and click **View cluster** (2) to see the new roks-cluster details page. Copy your command in a note, you will use it later.\n\n  ![](images/7-cluster-mgmt-img.png)\n\n7.Back to the **Terminal** window. You need to set the kubernetes to use the previous created ROKS Hub context.\n\n  To set the the context to use your Hub cluster, run the command below:\n\n```\nkubectl config use-context roks-hub-cluster\n```\n\n8.Let's test the new context configuration. Run the command below to get the cluster nodes.\n```\noc get nodes\n```\n\n  ![](images/24-cloudpak-cli.png)\n\n  Great, you are accessing the ROKS cluster. Now you are ready to execute the generated command.\n\n9.**Paste** the generated command that you previously copied in the clipboard.  When you run the command, several Kubernetes objects are created in the multicluster-endpoint namespace.\n\n  ![](images/8-cluster-mgmt-img.png)\n\n  In case you will see the error: `error: unable to recognize STDIN: no matches for kind Endpoint in version \"multicloud.ibm.com/v1beta1\"`. Run the command again.\n\n10.You can view the progress by entering the command:\n\n```\noc get pods -n multicluster-endpoint\n```\n\n  Make sure all the pods are in the running state.\n\n  ![](images/9-cluster-mgmt-img.png)\n\n11.The cluster end point is ready when all the Pods are in Running state. Back to the browser window, make sure that the cluster status is **Ready** now (if necessary, refresh the details page).\n\n  ![](images/10-cluster-mgmt-img.png)\n\n12.On the page navigation breadcrumb, click on **Clusters** link.\n\n  ![](images/11-cluster-mgmt-img.png)\n\n13.Now you can see your hub-cluster on the clusters list. You can add labels to identify your new cluster. On the hub-cluster row, click on the three dots icon (1) and select **Edit labels** (2).\n\n  ![](images/12-cluster-mgmt-img.png)\n\n14.Add a new label, **environment** (1), and give a value **Dev** (2). Click **+** (3) and **save** (4) the changes.\n\n  ![](images/13-cluster-mgmt-img.png)\n\n  Great, your first cluster is ready! Now let's add your ROKS Managed cluster.\n\n15.Click **Add cluster** again.\n\n  ![](images/14-cluster-mgmt-img.png)\n\n16.Select again **Import an Existing cluster** (1) and click **Import** (2).\n\n  ![](images/5-cluster-mgmt-img.png)\n\n17.Enter **managed-roks** for cluster name (1) and **managed-roks** for namespace (2). Click **Generate command** to continue (3).\n\n  ![](images/15-cluster-mgmt-img.png)\n\n18.A curl command is generated that you will use to add the new cluster. Click **Copy command** button (1) and click **View cluster** (2) to see the new iks-cluster details page. Copy the generated command in a note, you will use it later.\n\n  ![](images/7-cluster-mgmt-img.png)\n\n19.Back to the **Terminal** window. You need to set the kubernetes to use the previous created ROKS Managed context.\n\n  To set the the context to use your ROKS Managed cluster, run the command below:\n\n```\nkubectl config use-context roks-managed-cluster\n```\n\n20.Let's test the new context configuration. Run the command below to get the cluster nodes.\n\n```\noc get nodes\n```\n\n  ![](images/37-cloudpak-cli.png)\n\n  Great, you are accessing the ROKS Managed cluster. Now you are ready to execute the generated command.\n\n21.**Paste** the generated command that you previously copied in the clipboard. When you run the command, several Kubernetes objects are created in the multicluster-endpoint namespace.\n\n  ![](images/17-cluster-mgmt-img.png)\n\n  In case you will see the error: `error: unable to recognize STDIN: no matches for kind Endpoint in version \"multicloud.ibm.com/v1beta1\"`. Run the command again.\n\n22.You can view the progress by entering the command:\n\n```\noc get pods -n multicluster-endpoint\n```\n\n  Make sure all the pods are in the running state.\n\n  ![](images/9-cluster-mgmt-img.png)\n\n23.Back to the browser window, make sure that the cluster status is **Ready** now (if necessary, refresh the details page).\n\n  ![](images/18-cluster-mgmt-img.png)\n\n24.On the page navigation breadcrumb, click on **Clusters** link.\n\n  ![](images/19-cluster-mgmt-img.png)\n\n25.Now you can see your managed-roks on the clusters list. You can add labels to identify your new cluster. On the managed-roks row, click on the three dots icon (1) and select **Edit labels** (2).\n\n  ![](images/20-cluster-mgmt-img.png)\n\n26.Add a new label, **environment** (1), and give a value **QA** (2). Click **+** (3) and **save** (4) the changes.\n\n  ![](images/21-cluster-mgmt-img.png)\n\n  Great, your both clusters are ready and managed by IBM Cloud Pak for Multicloud Management. Using this Pak, you are able to manage both cluster from a single pane of glass. Let's check it in the next section.\n\n***\n\n## Visualize Clusters\n\nIn this section, you visualize clusters in a tabular view.\n\n1.With IBM Cloud Pak for Multicloud Management you are able to manage all your cluster from a single control panel. Open the **Menu** button (1) and click **Observe environments** (2) > **Overview** (3).\n\n  ![](images/22-cluster-mgmt-img.png)\n\n2.The Overview menu option displays the status of all clusters including the health and resource metrics. The top section shows the operations details across all your cloud providers. In the first section, you can see information about cloud providers, compute resources, applications and infrastructure. Because your both clusters are completely new, you don't have a lot of information here. But in a real production environment here is your starting point to explore your multiple clusters.\n\n  ![](images/23-cluster-mgmt-img.png)\n\n3.The bottom section shows Resource Overview. Here you can see Cluster Compliance status, Cluster status, CPU, Memory, and Storage Resource View.\n\n  ![](images/24-cluster-mgmt-img.png)\n\n4.Now, navigate to the **Applications** page. Select “hamburger” **menu** in the top-left corner (1) and then **Manage applications** (2) and **Hybrid applications** (3).\n\n  ![](images/25-cluster-mgmt-img.png)\n\n5.By now, you don’t have any application here. But it is important to know, that in this area, you will see information about the deployment of an application. Don’t worry about it now, you will explore it later.\n\n  ![](images/26-cluster-mgmt-img.png)\n\n9.Now, let’s explore a really good feature of Multicloud Management: Visual Web Terminal. On the top right navigator, click on **Visual Web Terminal** button.\n\n  ![](images/27-cluster-mgmt-img.png)\n\n10.You can use the Visual Web Terminal to run many commands across your environment. When categorized data is returned, such as when you enter a search command, it is returned in an interactive tabular format.\n\n  The Visual Web Terminal is particularly useful when troubleshooting issues that require running multiple commands and navigating the results of the commands in an easy way. Let’s try something simple! Enter the command bellow:\n\n```\noc project multicluster-endpoint\n```\n\n```\noc get pods\n```\n\n  ![](images/31-cluster-mgmt-img.png)\n\n  The information that is provided in the Visual Web Terminal is limited by the permissions of the user. When you run a command, only the items that you have permission to view are displayed.\n\n  Next section, you learn how to deploy an application to the local or remote cluster.\n\n***\n\n## Deploy an Application\n\nIn this step, you install a helm chart from the catalog to your hub-cluster and your managed-roks cluster. Let's do it!\n\n1.Open the **Menu** (1) and click on **Administer** (2) > **Helm repository** (3).\n\n  ![](images/32-cluster-mgmt-img.png)\n\n2.On the Helm Repositories page, click **Add Repository** to register a new Helm Repository.\n\n  ![add repository](images/2020-09-18-16-00-28.png)\n\n3.Enter **dte-charts** (1) as repository Name, and enter **https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator** as URL (2). Click **Add** (3).\n\n  ![repo add dialog](images/2020-09-18-16-02-55.png)\n\n4.After few seconds, you should see Sync Status as **Completed** (1). Now, let’s deploy an application from this new Helm repository. Click **Catalog** (2) on upper right corner of the page to view the list of helm charts that you can deploy.\n\n  ![helm repo added](images/2020-09-18-16-05-20.png)\n\n5.Search for **mod** (1) and select **modresortapp** (2) application.\n\n  ![modresortapp](images/2020-09-18-16-07-07.png)\n\n6.The chart deploys a simple Liberty web application for demonstration purposes. Select **Configure** to continue.\n\n  ![configure](images/2020-09-18-16-08-32.png)\n\n7.Enter **demo** as Helm release name (1), select **default** as Target namespace (2). On Target cluster, select the **local-cluster** (3). Then click **Install** (4).\n\n  ![install](images/2020-09-18-16-12-42.png)\n\n8.The installation starts immediately but it takes a few minutes to deploy the application to remote cluster. Click **View Helm Releases** to view the status.\n\n  ![](images/2020-09-18-16-14-00.png)\n\n9.On the Helm releases page, you can check that **demo** helm is deployed to your Hub cluster.\n\n  ![](images/2020-09-18-16-15-10.png)\n\n10.Now, go back to the **Hybrid applications** menu, Menu hamburger -> Manage Applications -> Hybrid Applications. You can notice that now it shows your just deployed application. Click the **demo-modresrtapp** application.\n\n  NOTE: if you don't see the Manage Applications option in the menu, change your browser url and remove the /catalog/instances context.\n\n  ![](images/2020-09-18-16-27-52.png)\n\n11.You should see the details of the sample application, as shown below. Click on any of the icons to see the details of each object.\n\n  ![](images/2020-09-18-16-38-53.png)\n\n12.Click the **demo-modresortapp** placement rule (1) and notice that it defines the placement of the application to the clusters with label **environment=Dev** (2). It also specify that one instance of the application should be deployed in case more clusters is labeled this way.\n\n  ![](images/2020-09-18-16-43-05.png)\n\n13.Let's modify the target cluster. Edit the label in the yaml file on the right (1) changing the **Dev** to **QA** and apply the changes with the **Update** icon (2)\n\n  ![](images/2020-09-18-20-22-10.png)\n\n14.In a short time you should notice that the placement rule change is picked by the system and the different target cluster is designeted as a target for deployment.\n\n  ![](images/33-cluster-mgmt-img.png)\n\n15.Let's verify that the application is actually running on Managed ROKS cluster. Go back to the terminal windows and run the following commands:\n\n  ```\n  kubectl config use-context roks-managed-cluster\n  oc project default\n  oc get pods\n  oc get service\n  ```\n\n  ![](images/34-cluster-mgmt-img.png)\n\n16.Now that you know the service name (demo-devchan-modresortchan-service), let’s create a route by exposing our service using the command below:\n\n```\noc expose service demo-devchan-modresortchan-service\n```\n\n17.View your new route:\n\n```\noc get route | grep demo\n```\n\n  ![](images/43-cluster-mgmt-img.png)\n\n  Copy the route of your application.\n\n18.Back to your browser window, open a new tab and enter the url below, where [exposed-route]is the route copied in the previous step.\n```\nhttp://[exposed-route]/resorts\n```\n\n  ![](images/44-cluster-mgmt-img.png)\n\n19.Great! Your Liberty application is available on your managed-roks cluster.\n\n  This application is really a simple sample, just to show you how easy is to install an application from the catalog in multiple clusters. In our next lab you will deploy a hybrid application learning details about Application Management deployment using channels and subscriptions concepts.\n\n\n\n## Manage Cluster Objects\n\nYou can use the management console to create, manage, view details, and troubleshoot application resources and Kubernetes objects in all clusters from a single interface. The management console search page supports searching for application resources by the component kind for each resource.\n\n1.Back to the IBM Cloud Pak for Multicloud Management web page tab, click on the **Search** button.\n\n  ![](images/46-cluster-mgmt-img.png)\n\n2.The Search menu gives access to application resources and Kubernetes objects. The Search overview screen displays commonly used search templates - a pre-defined template to view workloads, unhealthy pods and workloads created in last hour. You can also create your own search templates. Click on **Created Last Hour** button.\n\n  ![](images/47-cluster-mgmt-img.png)\n\n3.If you scroll down to the Pod section, you should see the demo-modresort pod that you created earlier in the list along with other pods. You can also provide the search criteria in the filter section. For example: type kind and select pod, provide the modresort as search string and specify status as Running.\n\n  ![](images/48-cluster-mgmt-img.png)\n\n  Congratulations! You have successfully completed the lab “Multicluster Management with IBM Cloud Pak for Multicloud Management”.\n\n***\n\n## Summary\n\nYou completed the Cloud Pak for Multicloud Management tutorial: Multi-cluster Management. Throughout the tutorial, you explored the key takeaways:\n- `Understand Cloud Pak for Multicloud Management`;\n- `Add a managed cluster`;\n- `Deploy an application chart`;\n-\t`Manage and monitor application resources of local and remote clusters`;\n\nIf you would like to learn more about Cloud Pak for Multicloud Management, please refer to:\n-\t<a href=\"https://www.ibm.com/cloud/cloud-pak-for-management\" target=\"blank\">Cloud Pak for Multicloud Management home page</a>\n- <a href=\"https://www.ibm.com/demos/collection/Cloud-Pak-for-Multicloud-Management\" target=\"blank\">Cloud Pak for Multicloud Management Demos </a>\n","type":"Mdx","contentDigest":"3aef8c4bcedd866f17359aa15652788a","counter":1502,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Lab 1 - Multicluster Management - ROKS","description":null},"exports":{},"rawBody":"---\ntitle: Lab 1 - Multicluster Management - ROKS\ndescription:\n---\n\n<FeatureCard\n  title=\"Multicluster Management with IBM Cloud Pak for Multicloud Management\"\n  color=\"dark\"\n  >\n\n![banner](/images/clustermgmt-banner.jpg)\n\n</FeatureCard>\n\n\n<AnchorLinks>\n  <AnchorLink>Lab Overview</AnchorLink>\n  <AnchorLink>Prerequisite</AnchorLink>\n  <AnchorLink>Business Context</AnchorLink>\n  <AnchorLink>Add Managed Clusters</AnchorLink>\n  <AnchorLink>Visualize Clusters</AnchorLink>\n  <AnchorLink>Deploy an Application</AnchorLink>\n  <AnchorLink>Manage Cluster Objects</AnchorLink>\n  <AnchorLink>Summary</AnchorLink>\n</AnchorLinks>\n\nNote: 'This lab is to be used for CP4MCM 2.1.X on ROKS.'\n\n***\n\n## Lab Overview\n\nIBM Cloud Pak for Multicloud Management provides consistent visibility, automation, and governance across a range of multicloud management capabilities such as cost and asset management, infrastructure management, application management, multi-cluster management, edge management, and integration with existing tools and processes. Customers can leverage Cloud Pak for Multicloud Management to simplify their IT and application ops management, while increasing flexibility and cost savings with intelligent data analysis driven by predictive signals.\n\nIBM Cloud Pak for Multicloud Management can manage Kubernetes clusters that are deployed on any target infrastructure - either in your own data center or in a public cloud.\n\nIn this tutorial, you will explore the following key capabilities:\n-\t`Understand Cloud Pak for Multicloud Management`\n-\t`Learn how to add a managed cluster`\n-\t`Learn how to deploy an application chart from catalog`\n-\t`Learn how to manage cluster objects spanning multiple clusters`\n\n***\n\n## Prerequisite\n\n- You need to have your personal CP4MCM on ROKS environment (check [here](../../environment/overview/) how to request it).\n- You need to pre-install all necessaries CLI tools (check [here](../installcli/) how to install them).\n\n***\n\n## Business Context\n\nAs a member of the Cloud Operation team, you are having problems to manage your multicloud hybrid world. Operate your cloud-based services and data across multiple providers is overwhelming your team.\nYour company is deploying multiple Kubernetes clusters to address their specific needs. Some Dev teams are deploying clusters across public and private clouds, and some are deploying clusters across regions, and some are deploying clusters to support the development and test needs.\n\nAs different teams deploy more clusters, new challenges are introduced:\n-\tWhere are my services running?\n-\tHow can I monitor applications across clusters and clouds?\n-\tHow can I manage clusters as if they were one environment?\n-\tHow do I monitor usage across clouds?\n-\tWhere are the failed components?\n-\tHow do I deploy applications across these environments?\n-\tHow do I move workloads across environments?\n-\tHow do I set consistent security policies across environments?\n-\tWhich clusters are compliant?\n-\tHow can I place workloads based on capacity, policy?\n\nBecause of that, you want to explore how IBM Cloud Pak for Multicloud Management, provides consistent visibility, governance and automation of your complex environment.\n\nIn this tutorial, you use two Red Hat OpenShift cluster (ROKS) clusters.\n-\tHub cluster includes management console, federated monitoring, and all the controllers. In this tutorial, you identify Hub cluster as hub-cluster. Here is the OpenShift cluster.\n-\tManaged cluster includes klusterlet components that communicate status back to the Hub cluster. In this tutorial, you identify managed cluster as managed-roks.\n\nThe relationship between hub and managed clusters is shown in the diagram below:\n\n![](images/1-cluster-mgmt-img.png)\n\nIn this tutorial, you will log in to the Hub cluster to do cluster management.\n\nYou will complete the following tasks:\n-\tAdd a managed cluster\n-\tVisualize cluster topology\n-\tVisualize clusters and launch to each cluster\n-\tDeploy an application chart to remote cluster\n-\tManage cluster objects\n\n***\n\n## Add Managed Clusters\n\nIn this section, you will add two new managed clusters in your Control Panel. As explained before, you will add your OpenShift ROKS Hub cluster and your OpenShift ROKS Managed cluster.\n\n1.To start the lab, you should be in your Cloud Pak for Multicloud Management Web Console. If you are not, check [here](../beforestart/) how to open your console page.\n\n  ![](images/2-cluster-mgmt-img.png)\n\n2.Now, let's explore the Cluster view. Click the hamburger **Menu** (1) and select **Automated Infrastructure -> Clusters** (2).\n\n  ![](images/3-cluster-mgmt-img.png)\n\n3.Initially, you shouldn't have any cluster registered here. Let's add our first cluster. Click **Add cluster**.\n\n  ![](images/4-cluster-mgmt-img.png)\n\n4.You can add a cluster by Importing an existing cluster or provisioning a new cluster that uses IBM Cloud Automation Manager. We use the first option. Select **Import an Existing cluster** (1) and click **Import** (2).\n\n  ![](images/5-cluster-mgmt-img.png)\n\n5.Enter **hub-cluster** for cluster name (1) and **hub-cluster** for namespace (2). You can view the yaml file and change the settings as needed (3). To import an OpenShift cluster no further changes are needed. Click **Generate command** to continue (4).\n\n  ![](images/6-cluster-mgmt-img.png)\n\n6.A curl command is generated that you will use to add the new cluster. Click **Copy command** button (1) and click **View cluster** (2) to see the new roks-cluster details page. Copy your command in a note, you will use it later.\n\n  ![](images/7-cluster-mgmt-img.png)\n\n7.Back to the **Terminal** window. You need to set the kubernetes to use the previous created ROKS Hub context.\n\n  To set the the context to use your Hub cluster, run the command below:\n\n```\nkubectl config use-context roks-hub-cluster\n```\n\n8.Let's test the new context configuration. Run the command below to get the cluster nodes.\n```\noc get nodes\n```\n\n  ![](images/24-cloudpak-cli.png)\n\n  Great, you are accessing the ROKS cluster. Now you are ready to execute the generated command.\n\n9.**Paste** the generated command that you previously copied in the clipboard.  When you run the command, several Kubernetes objects are created in the multicluster-endpoint namespace.\n\n  ![](images/8-cluster-mgmt-img.png)\n\n  In case you will see the error: `error: unable to recognize STDIN: no matches for kind Endpoint in version \"multicloud.ibm.com/v1beta1\"`. Run the command again.\n\n10.You can view the progress by entering the command:\n\n```\noc get pods -n multicluster-endpoint\n```\n\n  Make sure all the pods are in the running state.\n\n  ![](images/9-cluster-mgmt-img.png)\n\n11.The cluster end point is ready when all the Pods are in Running state. Back to the browser window, make sure that the cluster status is **Ready** now (if necessary, refresh the details page).\n\n  ![](images/10-cluster-mgmt-img.png)\n\n12.On the page navigation breadcrumb, click on **Clusters** link.\n\n  ![](images/11-cluster-mgmt-img.png)\n\n13.Now you can see your hub-cluster on the clusters list. You can add labels to identify your new cluster. On the hub-cluster row, click on the three dots icon (1) and select **Edit labels** (2).\n\n  ![](images/12-cluster-mgmt-img.png)\n\n14.Add a new label, **environment** (1), and give a value **Dev** (2). Click **+** (3) and **save** (4) the changes.\n\n  ![](images/13-cluster-mgmt-img.png)\n\n  Great, your first cluster is ready! Now let's add your ROKS Managed cluster.\n\n15.Click **Add cluster** again.\n\n  ![](images/14-cluster-mgmt-img.png)\n\n16.Select again **Import an Existing cluster** (1) and click **Import** (2).\n\n  ![](images/5-cluster-mgmt-img.png)\n\n17.Enter **managed-roks** for cluster name (1) and **managed-roks** for namespace (2). Click **Generate command** to continue (3).\n\n  ![](images/15-cluster-mgmt-img.png)\n\n18.A curl command is generated that you will use to add the new cluster. Click **Copy command** button (1) and click **View cluster** (2) to see the new iks-cluster details page. Copy the generated command in a note, you will use it later.\n\n  ![](images/7-cluster-mgmt-img.png)\n\n19.Back to the **Terminal** window. You need to set the kubernetes to use the previous created ROKS Managed context.\n\n  To set the the context to use your ROKS Managed cluster, run the command below:\n\n```\nkubectl config use-context roks-managed-cluster\n```\n\n20.Let's test the new context configuration. Run the command below to get the cluster nodes.\n\n```\noc get nodes\n```\n\n  ![](images/37-cloudpak-cli.png)\n\n  Great, you are accessing the ROKS Managed cluster. Now you are ready to execute the generated command.\n\n21.**Paste** the generated command that you previously copied in the clipboard. When you run the command, several Kubernetes objects are created in the multicluster-endpoint namespace.\n\n  ![](images/17-cluster-mgmt-img.png)\n\n  In case you will see the error: `error: unable to recognize STDIN: no matches for kind Endpoint in version \"multicloud.ibm.com/v1beta1\"`. Run the command again.\n\n22.You can view the progress by entering the command:\n\n```\noc get pods -n multicluster-endpoint\n```\n\n  Make sure all the pods are in the running state.\n\n  ![](images/9-cluster-mgmt-img.png)\n\n23.Back to the browser window, make sure that the cluster status is **Ready** now (if necessary, refresh the details page).\n\n  ![](images/18-cluster-mgmt-img.png)\n\n24.On the page navigation breadcrumb, click on **Clusters** link.\n\n  ![](images/19-cluster-mgmt-img.png)\n\n25.Now you can see your managed-roks on the clusters list. You can add labels to identify your new cluster. On the managed-roks row, click on the three dots icon (1) and select **Edit labels** (2).\n\n  ![](images/20-cluster-mgmt-img.png)\n\n26.Add a new label, **environment** (1), and give a value **QA** (2). Click **+** (3) and **save** (4) the changes.\n\n  ![](images/21-cluster-mgmt-img.png)\n\n  Great, your both clusters are ready and managed by IBM Cloud Pak for Multicloud Management. Using this Pak, you are able to manage both cluster from a single pane of glass. Let's check it in the next section.\n\n***\n\n## Visualize Clusters\n\nIn this section, you visualize clusters in a tabular view.\n\n1.With IBM Cloud Pak for Multicloud Management you are able to manage all your cluster from a single control panel. Open the **Menu** button (1) and click **Observe environments** (2) > **Overview** (3).\n\n  ![](images/22-cluster-mgmt-img.png)\n\n2.The Overview menu option displays the status of all clusters including the health and resource metrics. The top section shows the operations details across all your cloud providers. In the first section, you can see information about cloud providers, compute resources, applications and infrastructure. Because your both clusters are completely new, you don't have a lot of information here. But in a real production environment here is your starting point to explore your multiple clusters.\n\n  ![](images/23-cluster-mgmt-img.png)\n\n3.The bottom section shows Resource Overview. Here you can see Cluster Compliance status, Cluster status, CPU, Memory, and Storage Resource View.\n\n  ![](images/24-cluster-mgmt-img.png)\n\n4.Now, navigate to the **Applications** page. Select “hamburger” **menu** in the top-left corner (1) and then **Manage applications** (2) and **Hybrid applications** (3).\n\n  ![](images/25-cluster-mgmt-img.png)\n\n5.By now, you don’t have any application here. But it is important to know, that in this area, you will see information about the deployment of an application. Don’t worry about it now, you will explore it later.\n\n  ![](images/26-cluster-mgmt-img.png)\n\n9.Now, let’s explore a really good feature of Multicloud Management: Visual Web Terminal. On the top right navigator, click on **Visual Web Terminal** button.\n\n  ![](images/27-cluster-mgmt-img.png)\n\n10.You can use the Visual Web Terminal to run many commands across your environment. When categorized data is returned, such as when you enter a search command, it is returned in an interactive tabular format.\n\n  The Visual Web Terminal is particularly useful when troubleshooting issues that require running multiple commands and navigating the results of the commands in an easy way. Let’s try something simple! Enter the command bellow:\n\n```\noc project multicluster-endpoint\n```\n\n```\noc get pods\n```\n\n  ![](images/31-cluster-mgmt-img.png)\n\n  The information that is provided in the Visual Web Terminal is limited by the permissions of the user. When you run a command, only the items that you have permission to view are displayed.\n\n  Next section, you learn how to deploy an application to the local or remote cluster.\n\n***\n\n## Deploy an Application\n\nIn this step, you install a helm chart from the catalog to your hub-cluster and your managed-roks cluster. Let's do it!\n\n1.Open the **Menu** (1) and click on **Administer** (2) > **Helm repository** (3).\n\n  ![](images/32-cluster-mgmt-img.png)\n\n2.On the Helm Repositories page, click **Add Repository** to register a new Helm Repository.\n\n  ![add repository](images/2020-09-18-16-00-28.png)\n\n3.Enter **dte-charts** (1) as repository Name, and enter **https://raw.githubusercontent.com/dymaczew/charts/master/repo/incubator** as URL (2). Click **Add** (3).\n\n  ![repo add dialog](images/2020-09-18-16-02-55.png)\n\n4.After few seconds, you should see Sync Status as **Completed** (1). Now, let’s deploy an application from this new Helm repository. Click **Catalog** (2) on upper right corner of the page to view the list of helm charts that you can deploy.\n\n  ![helm repo added](images/2020-09-18-16-05-20.png)\n\n5.Search for **mod** (1) and select **modresortapp** (2) application.\n\n  ![modresortapp](images/2020-09-18-16-07-07.png)\n\n6.The chart deploys a simple Liberty web application for demonstration purposes. Select **Configure** to continue.\n\n  ![configure](images/2020-09-18-16-08-32.png)\n\n7.Enter **demo** as Helm release name (1), select **default** as Target namespace (2). On Target cluster, select the **local-cluster** (3). Then click **Install** (4).\n\n  ![install](images/2020-09-18-16-12-42.png)\n\n8.The installation starts immediately but it takes a few minutes to deploy the application to remote cluster. Click **View Helm Releases** to view the status.\n\n  ![](images/2020-09-18-16-14-00.png)\n\n9.On the Helm releases page, you can check that **demo** helm is deployed to your Hub cluster.\n\n  ![](images/2020-09-18-16-15-10.png)\n\n10.Now, go back to the **Hybrid applications** menu, Menu hamburger -> Manage Applications -> Hybrid Applications. You can notice that now it shows your just deployed application. Click the **demo-modresrtapp** application.\n\n  NOTE: if you don't see the Manage Applications option in the menu, change your browser url and remove the /catalog/instances context.\n\n  ![](images/2020-09-18-16-27-52.png)\n\n11.You should see the details of the sample application, as shown below. Click on any of the icons to see the details of each object.\n\n  ![](images/2020-09-18-16-38-53.png)\n\n12.Click the **demo-modresortapp** placement rule (1) and notice that it defines the placement of the application to the clusters with label **environment=Dev** (2). It also specify that one instance of the application should be deployed in case more clusters is labeled this way.\n\n  ![](images/2020-09-18-16-43-05.png)\n\n13.Let's modify the target cluster. Edit the label in the yaml file on the right (1) changing the **Dev** to **QA** and apply the changes with the **Update** icon (2)\n\n  ![](images/2020-09-18-20-22-10.png)\n\n14.In a short time you should notice that the placement rule change is picked by the system and the different target cluster is designeted as a target for deployment.\n\n  ![](images/33-cluster-mgmt-img.png)\n\n15.Let's verify that the application is actually running on Managed ROKS cluster. Go back to the terminal windows and run the following commands:\n\n  ```\n  kubectl config use-context roks-managed-cluster\n  oc project default\n  oc get pods\n  oc get service\n  ```\n\n  ![](images/34-cluster-mgmt-img.png)\n\n16.Now that you know the service name (demo-devchan-modresortchan-service), let’s create a route by exposing our service using the command below:\n\n```\noc expose service demo-devchan-modresortchan-service\n```\n\n17.View your new route:\n\n```\noc get route | grep demo\n```\n\n  ![](images/43-cluster-mgmt-img.png)\n\n  Copy the route of your application.\n\n18.Back to your browser window, open a new tab and enter the url below, where [exposed-route]is the route copied in the previous step.\n```\nhttp://[exposed-route]/resorts\n```\n\n  ![](images/44-cluster-mgmt-img.png)\n\n19.Great! Your Liberty application is available on your managed-roks cluster.\n\n  This application is really a simple sample, just to show you how easy is to install an application from the catalog in multiple clusters. In our next lab you will deploy a hybrid application learning details about Application Management deployment using channels and subscriptions concepts.\n\n\n\n## Manage Cluster Objects\n\nYou can use the management console to create, manage, view details, and troubleshoot application resources and Kubernetes objects in all clusters from a single interface. The management console search page supports searching for application resources by the component kind for each resource.\n\n1.Back to the IBM Cloud Pak for Multicloud Management web page tab, click on the **Search** button.\n\n  ![](images/46-cluster-mgmt-img.png)\n\n2.The Search menu gives access to application resources and Kubernetes objects. The Search overview screen displays commonly used search templates - a pre-defined template to view workloads, unhealthy pods and workloads created in last hour. You can also create your own search templates. Click on **Created Last Hour** button.\n\n  ![](images/47-cluster-mgmt-img.png)\n\n3.If you scroll down to the Pod section, you should see the demo-modresort pod that you created earlier in the list along with other pods. You can also provide the search criteria in the filter section. For example: type kind and select pod, provide the modresort as search string and specify status as Running.\n\n  ![](images/48-cluster-mgmt-img.png)\n\n  Congratulations! You have successfully completed the lab “Multicluster Management with IBM Cloud Pak for Multicloud Management”.\n\n***\n\n## Summary\n\nYou completed the Cloud Pak for Multicloud Management tutorial: Multi-cluster Management. Throughout the tutorial, you explored the key takeaways:\n- `Understand Cloud Pak for Multicloud Management`;\n- `Add a managed cluster`;\n- `Deploy an application chart`;\n-\t`Manage and monitor application resources of local and remote clusters`;\n\nIf you would like to learn more about Cloud Pak for Multicloud Management, please refer to:\n-\t<a href=\"https://www.ibm.com/cloud/cloud-pak-for-management\" target=\"blank\">Cloud Pak for Multicloud Management home page</a>\n- <a href=\"https://www.ibm.com/demos/collection/Cloud-Pak-for-Multicloud-Management\" target=\"blank\">Cloud Pak for Multicloud Management Demos </a>\n","fileAbsolutePath":"/Users/dymaczew/Documents/_code/mcm/cp4mcm-demohub/src/pages/roks/clustermgmt/index.mdx"}}},"staticQueryHashes":["1364590287","2102389209","2102389209","227138135","227138135","2456312558","2746626797","2746626797","3018647132","3018647132","3906363820","3906363820","768070550"]}